<% leaderboards.each do |leaderboard| %>
  <%
    participants = leaderboard_participants(leaderboard)
    challenge    = leaderboard.challenge
  %>

  <tr>
    <td class="leaderboard-change">
      <%= leaderboard_ranking_change(leaderboard) %>
    </td>
    <td><strong><%= "%02d" % (leaderboard.row_num) %></strong></td>
    <td>
      <% if participants.empty? %>
        <%= image_tag default_image_url, class: 'avatar' %>
        <span class="text-link">Unknown User</span>
      <% elsif participants.length == 1 %>
        <%= render partial: 'participants/user_link', locals: { participant: participants[0] } %>
      <% else %>
        <% team = leaderboard.team %>

        <% if team.present? %>
          <%= link_to team.name, challenge_team_path(team.challenge, team) %>
        <% else %>
          <span>#</span>
        <% end %>

        <div class="avatar-group">
          <% participants.each do |participant| %>
            <%= render partial: 'participants/user_link', locals: { participant: participant, username: false } %>
          <% end %>
        </div>
      <% end %>
    </td>

    <% if challenge.media_on_leaderboard %>
      <td>
        <%= render partial: 'shared/challenges/media', locals: { mediable: leaderboard, submission_id: leaderboard.submission_id, size: :thumb } %>
      </td>
    <% end %>

    <td><strong><%= leaderboard_formatted_value(@current_round, leaderboard.score) %></strong></td>
    <td><strong><%= leaderboard_formatted_value(@current_round, leaderboard.score_secondary) %></strong></td>
    <% leaderboard_other_scores_array(leaderboard, challenge).each do |other_score| %>
      <td><strong><%= other_score %></strong></td>
    <% end %>
    <td><%= leaderboard.entries %></td>

    <td class="text-right"><%= local_time(leaderboard.created_at, "%a, %e %b %Y %H:%M") %></td>
    <td class="text-right">
      <% if leaderboard.try(:submitter_type) != 'OldParticipant' && leaderboard.try(:submitter).present? && leaderboard.try(:submission_id).present? %>
        <%= link_to 'View', challenge_submission_path(challenge, leaderboard.submission_id), class: 'btn btn-secondary btn-sm' %>
      <% else %>
        <%= link_to 'View', '#', class: 'btn btn-secondary btn-sm disabled disabled--with-pointer-events', title: 'Submitter or Submission was deleted' %>
      <% end %>
    </td>
    <td>
      <span data-title="<%= challenge.tagline %>" data-img="<%= s3_public_url(leaderboard, :large) if having_media_image?(challenge, leaderboard) %>" data-desc="<%= challenge.challenge %>" data-url="<%= "#{request.url}?utm_source=AIcrowd&utm_medium=Facebook" %>">
        <a data-url="<%= "#{request.url}?utm_source=AIcrowd&utm_medium=Facebook" %>" class="btn btn-facebook btn-sm mr-2" rel="nofollow" data-site="facebook" onclick="return SocialShareButton.share(this)" title="Share to Facebook" href="#" data-toggle="tooltip" data-placement="top" title="Share to Facebook">
          <img src="/assets/img/icon-facebook.svg">
        </a>
      </span>

      <span data-title="<%= challenge.tagline %>" data-desc="<%= challenge.challenge %>" data-img="<%= s3_public_url(leaderboard, :large) if having_media_image?(challenge, leaderboard) %>" data-url='<%= "#{request.url}?utm_source=AIcrowd&utm_medium=Twitter" %>'>
        <a data-url='<%= "#{request.url}?utm_source=AIcrowd&utm_medium=Twitter" %>' class="btn btn-twitter btn-sm" rel="nofollow" data-site="twitter" onclick="return SocialShareButton.share(this)" title="Share to Twitter" href="#" data-toggle="tooltip" data-placement="top" title="Share to Twitter">
          <img src="/assets/img/icon-twitter.svg">
        </a>
      </span>
    </td>
  </tr>
<% end %>
