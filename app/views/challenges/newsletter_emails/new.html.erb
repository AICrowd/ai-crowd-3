<%= render partial: 'shared/challenges/masthead', locals: { challenge: @challenge, challenge_rounds: @challenge_rounds, vote: @vote, follow: @follow } %>
<%= render partial: 'challenges/show/subnav', locals: { challenge: @challenge } %>

<!-- section -->
<section class="section-p-md">
  <div class="container-fluid">
    <div class="row">
      <%= form_with model: @newsletter_email_form, url: challenge_newsletter_emails_path(@challenge), class: 'newsletter-email-form', validate: true, local: true do |f| %>
        <% if @newsletter_email_form.errors.any? %>
          <%= render partial: 'shared/error_messages', locals: { target: @newsletter_email_form } %>
        <% end %>

        <div class="form-group">
          <span class="label-text">Groups</span>
          <%= f.select :group, @newsletter_email_groups, { include_blank: '--- Select a group ---' }, { class: 'form-control' } %>
        </div>

        <div class="form-group">
          <span class="label-text">Users</span>
          <%= f.select :users, @newsletter_email_form.users.to_a, { }, {
              id:       'challenge-participants-select2',
              class:    'form-control',
              multiple: true,
              data:     { controller: 'select2', 'select2-placeholder': 'Select participants', 'select2-url': search_api_v1_challenge_participants_url(@challenge) }
          } %>
        </div>

        <div class="form-group">
          <span class="label-text">CC</span>
          <%= f.text_field :cc, class: "form-control", placeholder: 'Enter e-mails separated by comma' %>
        </div>

        <div class="form-group">
          <span class="label-text">BCC</span>
          <%= f.text_field :bcc, class: "form-control", placeholder: 'Enter e-mails separated by comma' %>
        </div>

        <div class="form-group">
          <span class="label-text">Subject</span>
          <%= f.text_field :subject, class: "form-control", placeholder: 'E-mail subject' %>
        </div>

        <div class="form-group">
          <span class="label-text">Message</span>
          <div class="md-content">
            <%= f.text_area :message, class: "form-control", placeholder: 'E-mail message', data: { controller: "ckeditor" } %>
          </div>
        </div>

        <div class="btn-set" aria-hidden="true">
          <%= f.button 'Send Newsletter E-mail', class: 'btn btn-primary btn-sm', data: { disable_with: 'Saving...' } %>
        </div>
      <% end %>
    </div>
  </div>
</section>
<!-- /section -->
