<%= render partial: 'shared/challenges/masthead', locals: { challenge: @challenge, challenge_rounds: @challenge_rounds, vote: @vote, follow: @follow } %>
<%= render partial: 'challenges/show/subnav', locals: { challenge: @challenge } %>

<!-- section -->
<section class="section-p-md">
  <div class="container-fluid">
    <div class="row">
      <%= form_with model: @newsletter_email_form, url: challenge_newsletter_emails_path(@challenge), validate: true, local: true do |f| %>
        <% if @newsletter_email_form.errors.any? %>
          <%= render partial: 'shared/error_messages', locals: { target: @newsletter_email_form } %>
        <% end %>

        <div class="form-group">
          <span class="label-text">Groups</span>
          <%= f.select :group, @newsletter_email_groups, { include_blank: true }, { class: 'form-control' } %>
        </div>

        <div class="form-group">
          <span class="label-text">Users</span>
          <%= f.select :organizer_ids, @organizers_for_select.to_a, { include_blank: true }, { multiple: true, id: 'challenge-participants-select2', class: 'form-control' } %>
        </div>

        <script>
          $('#challenge-participants-select2').select2({
            ajax: {
              delay: 100,
              url: 'http://localhost:3000/api/v1/challenges/dsadsadasdsds/participants/search',
              dataType: 'json'
              // Additional AJAX parameters go here; see the end of this chapter for the full code of this example
            }
          });
        </script>

        <div class="form-group">
          <span class="label-text">CC</span>
          <%= f.text_field :cc, class: "form-control" %>
        </div>

        <div class="form-group">
          <span class="label-text">BCC</span>
          <%= f.text_field :bcc, class: "form-control" %>
        </div>

        <div class="form-group">
          <span class="label-text">Subject</span>
          <%= f.text_field :subject, class: "form-control" %>
        </div>

        <div class="form-group">
          <span class="label-text">Message</span>
          <div class="md-content">
            <%= f.text_area :message, class: "form-control", data: { controller: "ckeditor" } %>
          </div>
        </div>

        <div class="btn-set" aria-hidden="true">
          <%= f.button 'Send Newsletter E-mail', class: 'btn btn-primary btn-sm', data: { disable_with: 'Saving...' } %>
        </div>
      <% end %>
    </div>
  </div>
</section>
<!-- /section -->
